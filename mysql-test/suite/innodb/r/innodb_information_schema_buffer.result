SELECT * FROM INFORMATION_SCHEMA.INNODB_BUFFER_POOL_STATS;
SELECT count(*) FROM INFORMATION_SCHEMA.INNODB_BUFFER_POOL_STATS;
SELECT * FROM INFORMATION_SCHEMA.INNODB_BUFFER_PAGE;
SELECT COUNT(*) FROM INFORMATION_SCHEMA.INNODB_BUFFER_PAGE;
CREATE TABLE infoschema_buffer_test (col1 INT) ENGINE = INNODB;
INSERT INTO infoschema_buffer_test VALUES(9);
SELECT TABLE_NAME, INDEX_NAME, NUMBER_RECORDS, DATA_SIZE, PAGE_STATE, PAGE_TYPE
FROM INFORMATION_SCHEMA.INNODB_BUFFER_PAGE
WHERE TABLE_NAME like "%infoschema_buffer_test"
	and PAGE_STATE="file_page" and PAGE_TYPE="index";
TABLE_NAME	INDEX_NAME	NUMBER_RECORDS	DATA_SIZE	PAGE_STATE	PAGE_TYPE
test/infoschema_buffer_test	GEN_CLUST_INDEX	1	29	FILE_PAGE	INDEX
INSERT INTO infoschema_buffer_test VALUES(19);
SELECT TABLE_NAME, INDEX_NAME, NUMBER_RECORDS, DATA_SIZE, PAGE_STATE, PAGE_TYPE
FROM INFORMATION_SCHEMA.INNODB_BUFFER_PAGE
WHERE TABLE_NAME like "%infoschema_buffer_test"
and PAGE_STATE="file_page" and PAGE_TYPE="index";
TABLE_NAME	INDEX_NAME	NUMBER_RECORDS	DATA_SIZE	PAGE_STATE	PAGE_TYPE
test/infoschema_buffer_test	GEN_CLUST_INDEX	2	58	FILE_PAGE	INDEX
CREATE INDEX idx ON infoschema_buffer_test(col1);
SELECT TABLE_NAME, INDEX_NAME, NUMBER_RECORDS, DATA_SIZE, PAGE_STATE, PAGE_TYPE
FROM INFORMATION_SCHEMA.INNODB_BUFFER_PAGE
WHERE TABLE_NAME like "%infoschema_buffer_test"
and PAGE_STATE="file_page" and INDEX_NAME = "idx" and PAGE_TYPE="index";
TABLE_NAME	INDEX_NAME	NUMBER_RECORDS	DATA_SIZE	PAGE_STATE	PAGE_TYPE
test/infoschema_buffer_test	idx	2	32	FILE_PAGE	INDEX
DROP TABLE infoschema_buffer_test;
SELECT TABLE_NAME, INDEX_NAME, NUMBER_RECORDS, DATA_SIZE, PAGE_STATE, PAGE_TYPE
FROM INFORMATION_SCHEMA.INNODB_BUFFER_PAGE
WHERE TABLE_NAME like "%infoschema_buffer_test";
TABLE_NAME	INDEX_NAME	NUMBER_RECORDS	DATA_SIZE	PAGE_STATE	PAGE_TYPE
CREATE TABLE infoschema_parent (id INT NOT NULL, PRIMARY KEY (id))
ENGINE=INNODB;
CREATE TABLE infoschema_child (id INT, parent_id INT, INDEX par_ind (parent_id),
FOREIGN KEY (parent_id)
REFERENCES infoschema_parent(id)
ON DELETE CASCADE)
ENGINE=INNODB;
SELECT count(*)
FROM INFORMATION_SCHEMA.INNODB_BUFFER_PAGE
WHERE TABLE_NAME like "%infoschema_child" and PAGE_STATE="file_page"
and PAGE_TYPE="index";
count(*)
2
DROP TABLE infoschema_child;
DROP TABLE infoschema_parent;
#
# MYSQL-38: Counters in innodb_buffer_pool_stats seem broken
#
# Trigger a refresh of the per-second averages.
SELECT SLEEP(1);
SLEEP(1)
0
CREATE TABLE stats AS
SELECT NUMBER_PAGES_CREATED, NUMBER_PAGES_WRITTEN, NUMBER_PAGES_GET
FROM INFORMATION_SCHEMA.INNODB_BUFFER_POOL_STATS;
CREATE TABLE t1 (a INT) ENGINE=InnoDB;
INSERT INTO t1 VALUES (1);
DROP TABLE t1;
# Trigger a refresh of the per-second averages.
SELECT SLEEP(1);
SLEEP(1)
0
SELECT 1 AS STATUS
FROM stats, INFORMATION_SCHEMA.INNODB_BUFFER_POOL_STATS AS bp
WHERE stats.NUMBER_PAGES_CREATED <= bp.NUMBER_PAGES_CREATED;
STATUS
1
SELECT 1 AS STATUS
FROM stats, INFORMATION_SCHEMA.INNODB_BUFFER_POOL_STATS AS bp
WHERE stats.NUMBER_PAGES_WRITTEN <= bp.NUMBER_PAGES_WRITTEN;
STATUS
1
SELECT 1 AS STATUS
FROM stats, INFORMATION_SCHEMA.INNODB_BUFFER_POOL_STATS AS bp
WHERE stats.NUMBER_PAGES_GET <= bp.NUMBER_PAGES_GET;
STATUS
1
DROP TABLE stats;
